<html lang='en' class='dark'>
    <head>
        <meta charset='UTF-8' />
        <meta name='viewport' content='width=device-width, initial-scale=1.0' />
        <title>TN intelligence Quiz</title>
        <script>
            // Force dark mode before any rendering
            document.documentElement.classList.add('dark');
        </script>
        <script>
            // Pre-bootstrap script: Load runtime environment from /env.json
            // This runs before the React app starts, ensuring window.__ENV__ is available
            (function() {
                // Cache-bust the env.json fetch to ensure fresh config on every load
                var cacheBuster = 'cb=' + Date.now();
                
                // Track runtime status for diagnostics
                window.__ENV_LOAD_STATUS__ = 'loading';
                
                fetch('/env.json?' + cacheBuster, {
                    cache: 'no-store'
                })
                    .then(function(response) {
                        if (!response.ok) {
                            console.warn('[env.json] Not found or not accessible (status: ' + response.status + '). Using empty environment. For live deployments, ensure /env.json exists with a non-empty CANISTER_ID_BACKEND.');
                            window.__ENV__ = {};
                            window.__ENV_LOAD_STATUS__ = 'missing';
                            return null;
                        }
                        return response.json();
                    })
                    .then(function(env) {
                        if (env) {
                            window.__ENV__ = env;
                            window.__ENV_LOAD_STATUS__ = 'loaded';
                            console.log('[env.json] Runtime environment loaded successfully:', Object.keys(env).join(', '));
                        }
                    })
                    .catch(function(error) {
                        console.warn('[env.json] Failed to load:', error.message, '- Using empty environment. For live deployments, ensure /env.json is accessible with a non-empty CANISTER_ID_BACKEND.');
                        window.__ENV__ = {};
                        window.__ENV_LOAD_STATUS__ = 'error';
                    });
            })();
        </script>
    </head>
    <body>
        <div id='root'></div>
        <script type='module' src='/src/main.tsx'></script>
    </body>
</html>
